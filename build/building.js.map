{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/container.js","src/dom.js","src/index.js","src/map.js"],"names":[],"mappings":"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","file":"building.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import dom from './dom'\nimport { parseTemplate, loadMap } from './map'\nvar x = 0;\nvar y = 0;\nvar vertical = 0;\nvar horizontal = 0;\nvar speed = 5;\nvar directions = [];\n\nfunction createContainer(view, container) {\n    window.addEventListener('keydown', function(e) {\n        if (e.keyCode === 37 || e.keyCode === 65) { // <=\n            if (directions.indexOf('LEFT') === -1)\n                directions.push('LEFT');\n        }\n        if (e.keyCode === 38 || e.keyCode === 87) { // ^\n            if (directions.indexOf('FORWARD') === -1)\n                directions.push('FORWARD');\n        }\n        if (e.keyCode === 39 || e.keyCode === 68) { // =>\n            if (directions.indexOf('RIGHT') === -1)\n                directions.push('RIGHT');\n        }\n        if (e.keyCode === 40 || e.keyCode === 83) { // v\n            if (directions.indexOf('BACKWARD') === -1)\n                directions.push('BACKWARD');\n        }\n    });\n    window.addEventListener('keyup', function(e) {\n        if (e.keyCode === 37 || e.keyCode === 65) { // <=\n            if (directions.indexOf('LEFT') > -1)\n                directions.splice(directions.indexOf('LEFT'), 1);\n        }\n        if (e.keyCode === 38 || e.keyCode === 87) { // ^\n            if (directions.indexOf('FORWARD') > -1)\n                directions.splice(directions.indexOf('FORWARD'), 1);\n        }\n        if (e.keyCode === 39 || e.keyCode === 68) { // =>\n            if (directions.indexOf('RIGHT') > -1)\n                directions.splice(directions.indexOf('RIGHT'), 1);\n        }\n        if (e.keyCode === 40 || e.keyCode === 83) { // v\n            if (directions.indexOf('BACKWARD') > -1)\n                directions.splice(directions.indexOf('BACKWARD'), 1);\n        }\n\n    });\n    var prevX = 0, prevY = 0;\n    window.addEventListener('mousemove', function(e) {\n        vertical += (e.y - prevY) * 1.5 / view.clientHeight * 360 * (-1);\n        horizontal += (e.x - prevX) * 1.5 / view.clientWidth * 360;\n        move(container, x, y, vertical, horizontal);\n        prevY = e.y;\n        prevX = e.x;\n    })\n    var data = [{\n        x: 100,\n        y: 100,\n        w: 100,\n        l: 100,\n        h: 100\n    }, {\n        x: 150,\n        y: 100,\n        w: 100,\n        l: 100,\n        h: 150\n    }, {\n        x: 200,\n        y: 100,\n        w: 100,\n        l: 100,\n        h: 200\n    }, {\n        x: 150,\n        y: 100,\n        w: 100,\n        l: 100,\n        h: 250\n    }]\n\n    // loadMap(data).render(container);\n    parseTemplate(container);\n    window.requestAnimationFrame(() => {\n        walking(container);\n    })\n}\n\nfunction walking(world) {\n    var num = horizontal / 360 * Math.PI * 2;\n    if (directions.indexOf('FORWARD') > -1) {\n        x -= Math.sin(num) * speed;\n        y -= Math.cos(num) * speed;\n    }\n    if (directions.indexOf('LEFT') > -1) {\n        x += Math.cos(num) * speed;\n        y -= Math.sin(num) * speed;\n    }\n    if (directions.indexOf('RIGHT') > -1) {\n        x -= Math.cos(num) * speed;\n        y += Math.sin(num) * speed;\n    }\n    if (directions.indexOf('BACKWARD') > -1) {\n        x += Math.sin(num) * speed;\n        y += Math.cos(num) * speed;\n    }\n    move(world, x, y, vertical, horizontal)\n    window.requestAnimationFrame(() => {\n        walking(world);\n    })\n}\n\nfunction move(world, x, y, vertical, horizontal) {\n    world.style['transform-origin'] = (x * (-1)) + 'px ' + (y * (-1)) + 'px -150px';\n    // world.style['transform'] = 'translate3d(' + x + 'px, ' + y + 'px, 700px) ' +\n    //     'rotateX(' + vertical + 'deg) rotateY(0deg) rotateZ(' + horizontal + 'deg)';\n    dom.transform(world, {\n        translate: [x, y, 700],\n        rotate: [vertical, 0, horizontal]\n    })\n\n}\nexport {\n    createContainer\n};\n","var dom = {};\n\ndom.create = function(type) {\n    return document.createElement(type)\n}\n\ndom.transform = function(dom, options) {\n    var string =\n        `translate3d(${options.translate[0]}px, ${options.translate[1]}px, ${options.translate[2]}px) \\\n    rotateX(${options.rotate[0]}deg) \\\n    rotateY(${options.rotate[1]}deg) \\\n    rotateZ(${options.rotate[2]}deg)\n    `\n    dom.style.transform = string;\n    return dom;\n}\n\ndom.size = function(dom, options) {\n    // TODO: height(tall)\n    console.log(options);\n    dom.style.width = `${options.w}px`;\n    dom.style.height = `${options.l}px`;\n    dom.style['background-color'] = options.color;\n    return dom;\n}\nexport default dom;\n","import { createContainer } from './container.js'\n\n// for development\nwindow.createContainer = createContainer;\nexport {\n    createContainer\n}\n","import dom from './dom'\n\nfunction parseTemplate(root, level = 0) {\n    Array.from(root.childNodes).forEach(node => {\n        if (node.nodeType === 1) {\n            parseTemplate(node, ++level);\n            // FIXME: Will override previous transform attributes\n            dom.transform(node, {\n                translate: [0, 0, level * (-5)],\n                rotate: [0, 0, 0]\n            })\n        }\n    })\n}\n\nfunction loadMap(data) {\n    var map = [];\n    data.forEach(tile => {\n        map.push(createBuilding(tile))\n    })\n    return {\n        render: function(target) {\n            map.forEach(building => target.appendChild(building));\n        }\n    }\n}\n\nfunction createBuilding(options) {\n    options = Object.assign({\n        x: 0,\n        y: 0,\n        z: 0,\n        w: 100,\n        l: 100,\n        h: 100,\n        color: '#000'\n    }, options)\n\n    // TODO: Use compose function\n    return dom.size(\n        dom.transform(\n            dom.create('div'), {\n                translate: [options.x, options.y, options.x],\n                rotate: [0, 0, 0]\n            }), {\n            w: options.w,\n            l: options.l,\n            color: options.color\n        }\n    )\n}\nexport { parseTemplate, loadMap }\n"]}